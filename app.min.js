'use strict';(function(c){'use strict';// globals
var d=c.maquette,f=d.h,g=d.createProjector(),j={data:{},filter:'new',filters:['new','updated','cheap']},k=function k(p){Object.keys(p).forEach(function(q){j[q]=p[q]}),g.scheduleRender()},l=function l(p){var q={};if(j.data.data){switch(q=_.cloneDeep(j.data),p.target.textContent){case j.filters[0]:q.data.sort(function(r,s){return s.created_at_moment-r.created_at_moment});break;case j.filters[1]:q.data.sort(function(r,s){return s.price_updated_at_moment-r.price_updated_at_moment});break;case j.filters[2]:q.data.sort(function(r,s){return r.price-s.price});};}k({data:q,filter:p.target.textContent})},m=function m(p){var q=p.target.id,r=new Set(Object.keys(localStorage));localStorage[q]=r.has(q)&&'liked'===localStorage[q]?'':'liked'},n=function n(){return _.range(48).map(function(p){return f('article.listing',{key:p+'item'},[f('div.image_container',{key:p+'item_img'}),f('p.item_meta',{key:p+'item_meta'},[f('strong.designer',f('br')),f('span.title',f('br')),f('strong.price',f('br')),f('em.date',f('br'))])])})},o=function o(p){var q=new Set(Object.keys(localStorage));return p.map(function(r,s){return f('article#'+r.id+'.listing'+(q.has(r.id+'')&&'liked'===localStorage[r.id]?'.liked':''),{key:s+'item',onclick:m},[f('div#'+r.id+'.image_container',{key:s+'item_img'},f('img#'+r.id,{src:r.photos[0].url})),f('p#'+r.id+'.item_meta',{key:s+'item_meta'},[f('strong.designer',r.designer_names),f('span.title',r.title),f('strong.price','$'+r.price),f('em.date','updated'===j.filter?'updated '+r.price_updated_at_moment.fromNow():'created '+r.created_at_moment.fromNow())])])})};(function(p){var q=new XMLHttpRequest;q.addEventListener('load',function(r){var s=JSON.parse(q.responseText);s.data.forEach(function(t){t.created_at_moment=moment(t.created_at),t.price_updated_at_moment=moment(t.price_updated_at)}),s.data.sort(function(t,u){return u.created_at_moment-t.created_at_moment}),k({data:s})}),q.addEventListener('error',function(r){alert('There was an error retrieving data from '+p+', most likely due to a missing Access-Control-Allow-Origin header. Use the Chrome plugin Allow-Control-Origin: * to avoid that.')}),q.open('GET',p,!0),q.send(Date.now())})('https://www.grailed.com/api/listings/grailed'),g.merge(document.getElementById('app'),function(){var p=f('header',f('h1.app_title','grailed')),q=f('ul.filters',j.filters.map(function(s,t){return f('li.filter'+(j.filter===s?'.selected':''),{key:t,onclick:l},s)})),r=f('div.listings',j.data.data===void 0?n():o(j.data.data));return f('div',[p,q,r])})})(window);